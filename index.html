<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <title>Thakur Sheets</title>
  </head>
  <body>
    <div class="container py-5">
      <div class="row">
        <div
          class="col-lg-5 col-md-8 mx-auto shadow border bg-white p-4 rounded"
        >
          <h2 class="text-center fw-bold mb-3">Excel Maker</h2>
          <form name="google-sheet">
            <div id="form_alerts"></div>

            <!-- Input Fields -->

            <!-- Date -->
            <div class="form-group mb-3">
              <label for="date" class="form-label">Date</label>
              <input
                type="date"
                id="date"
                name="date"
                class="form-control"
                placeholder="Enter Date"
                required
              />
            </div>

            <!-- Refference Name -->
            <div class="form-group mb-3">
              <label for="refference" class="form-label">Refference Name</label>
              <input
                type="text"
                id="refference"
                name="refference"
                class="form-control"
                placeholder="Enter your Refference Name"
                required
              />
            </div>

            <!-- Name -->
            <div class="form-group mb-3">
              <label for="name" class="form-label">Name</label>
              <input
                type="text"
                id="name"
                name="name"
                class="form-control"
                placeholder="Enter your name"
                required
              />
            </div>

            <!-- Phone Number -->
            <div class="form-group mb-3">
              <label for="phone" class="form-label">Phone Number</label>
              <input
                type="number"
                id="phone"
                name="phone"
                class="form-control"
                placeholder="Enter your phone number"
                required
              />
            </div>

            <!-- Email -->
            <div class="form-group mb-3">
              <label for="email" class="form-label">Email</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-control"
                placeholder="Enter your email address"
                required
              />
            </div>

            <!-- Address -->
            <div class="form-group mb-3">
              <label for="address" class="form-label">Address</label>
              <textarea
                id="address"
                name="address"
                class="form-control"
                placeholder="Enter your address"
                rows="2"
                required
              ></textarea>
            </div>

            <!-- Expected Date -->
            <div class="form-group mb-3">
              <label for="expected" class="form-label">Expected Date</label>
              <input
                type="date"
                id="expected"
                name="expected"
                class="form-control"
                placeholder="Enter Expected Date"
                required
              />
            </div>

            <!-- Policy -->
            <div class="form-group mb-3">
              <label for="policy" class="form-label">Policy</label>
              <textarea
                id="policy"
                name="policy"
                class="form-control"
                placeholder="Enter Policy"
                rows="1"
                required
              ></textarea>
            </div>

            <!-- Premium Number -->
            <div class="form-group mb-3">
              <label for="premium" class="form-label">Premium Number</label>
              <input
                type="number"
                id="premium"
                name="premium"
                class="form-control"
                placeholder="Enter Premium Number"
                required
              />
            </div>

            <div>
              <button class="btn btn-primary me-2" type="submit">Send!!</button>
              <button class="btn btn-danger" type="reset">
                Reset the form!
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbwATZ1vfCCPbqEBu4VyViS9K5ceiHIf6wu8qAIrixKJ48J686k3mmmAtLDTYITUNMVkCg/exec";
      const form = document.forms["google-sheet"];

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        fetch(scriptURL, { method: "POST", body: new FormData(form) })
          .then((response) =>
            $("#form_alerts").html(
              "<div class='alert alert-success'>Data sent successfully.</div>"
            )
          )
          .catch((error) =>
            $("#form_alerts").html(
              "<div class='alert alert-danger'>Data not sent.</div>"
            )
          );
      });
    </script>
  </body>
</html>
